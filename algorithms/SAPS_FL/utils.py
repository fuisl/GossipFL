import torch
import numpy as np


Bandwidth_Decrease_Factor = 0.1



def generate_bandwidth(args):
    # args.bandwidth_type should be in ['real', 'random']
    workers = args.client_num_in_total
    if args.bandwidth_type == 'random':
        bandwidth = np.random.rand(workers, workers)*5
        for i in range(workers):
            for j in range(workers):
                if i < j :
                    bandwidth[i][j] = bandwidth[j][i]
                elif i == j :
                    bandwidth[i][j] = 0
    elif args.bandwidth_type == 'real':
        assert not (workers > 15)
        bandwidth_list = [[0, 1.3, 1.5, 1.2, 1.6, 1.6, 1.5, 1.6, 1.7, 1.4, 1.7, 1.5, 1.6, 1.5, 1.1],
                            [1.3, 0, 1.5, 1.2, 1.5, 1.5, 1.5, 1.6, 1.5, 1.2, 1.5, 1.5, 1.4, 1.6, 1.5],
                            [1.4, 1.3, 0, 1.3, 1.5, 1.6, 1.4, 1.7, 1.3, 1.6, 1.7, 1.4, 1.6, 1.4, 1.3],
                            [1.2, 1.3, 1.4, 0, 1.5, 1.4, 1.5, 1.5, 1.5, 1.2, 1.5, 1.6, 1.6, 1.6, 1.4],
                            [11.0, 2.2, 27.7, 6.8, 0, 82.5, 73.1, 82.2, 132.5, 49.1, 69.5, 84.8, 98.0, 57.4, 51.7],
                            [6.8, 1.1, 20.2, 4.7, 82.6, 0, 129.2, 269.2, 78.3, 73.3, 147.1, 50.3, 54.4, 37.0, 36.4],
                            [27.3, 1.1, 15.1, 21.8, 83.2, 184.8, 0, 331.2, 86.4, 76.8, 261.1, 62.4, 70.6, 42.3, 39.0],
                            [0.2, 13.9, 27.6, 14.8, 60.8, 195.3, 276.2, 0, 63.3, 75.4, 323.1, 50.3, 62.6, 39.8, 36.4],
                            [0.2, 16.9, 5.7, 1.1, 166.8, 83.9, 64.0, 61.6, 0, 40.7, 54.0, 80.4, 65.9, 39.1, 41.6],
                            [36.2, 27.4, 1.7, 22.0, 37.5, 48.6, 54.7, 50.0, 35.8, 0, 45.0, 33.5, 39.0, 22.5, 49.7],
                            [36.0, 0.6, 16.8, 21.1, 27.9, 115.1, 247.8, 317.4, 51.6, 47.5, 0, 48.1, 36.8, 24.4, 28.8],
                            [15.6, 28.6, 10.6, 8.1, 94.8, 45.4, 43.8, 46.3, 70.4, 27.0, 45.8, 0, 172.9, 39.4, 61.5],
                            [2.3, 3.9, 22.5, 5.7, 78.3, 45.6, 32.7, 34.5, 47.3, 23.2, 23.7, 134.5, 0, 31.2, 38.5],
                            [0.1, 15.1, 8.2, 15.4, 41.8, 32.7, 39.9, 37.9, 59.6, 25.0, 38.4, 38.2, 39.9, 0, 32.5],
                            [27.9, 17.2, 18.4, 24.1, 54.3, 36.6, 36.0, 39.2, 39.1, 69.7, 33.8, 59.7, 65.9, 30.7, 0]]
        bandwidth = np.array(bandwidth_list[0])
        for i in range(1, len(bandwidth_list)):
            bandwidth = np.vstack((bandwidth, np.array(bandwidth_list[i])))
        bandwidth = bandwidth[0:14,0:14]
    else:
        raise NotImplementedError

    return bandwidth










